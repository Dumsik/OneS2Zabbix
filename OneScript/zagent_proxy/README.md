Библиотека проксирования запросов zabbix_agent через HTTP
======================================================================

Оглавление
==========

- [Описание](#Описание)
- [Установка](#установка)

## Описание

zagent_proxy

zabbix_agent предназначена для проксирования запросов, поступающих от zabbix через zabbix_agent
к http сервисам 1С для вызова удаленных процедур. Применяется для мониторинга состояния параметров
1С, данные по которым либо трудно, либо невозможно получит без использования средств самой платформы

## Установка

1. Установка onescript
Скачать и установить свежую версию Onescript
https://oscript.io/downloads

2. Клонировать проек rac2zabbix в локальный репозиторий
>git clone /path/to/repo

3. Перейти в каталог проекта
>cd path/to/zagent_proxy

4. Выполнить сборку проекта
>opm build .

5. Установить проект
>opm install -f [имя .ospx файла].ospx (ospx файл создается командой build)

6. Добавить в конфигурационный файл zabbix агента строки

# проксирование запросов от zabbix_agent к стороннему http сервису
# 	type - строка, имя команды RPC
# 	body - строка JSON, прокси сформирует http запрос и передаст в него body как тело запроса
#	host - строка, адрес http сервиса (ip) с протоколом или без, куда будет проксирован запрос
#	db   - строка, имя базы данных
#	user - строка, пользователь для аутентификации на стороне http сервиса
#	password - строка, пароль пользователя для аутентификации на стороне http сервиса
#	timeout - строка, таймаут запроса к http сервису. Не обязательный, по умолчанию 30 сек
UserParameter=zabbix.http.proxy[*],zagent_proxy rpc -type $1 -body $2 -host $3 -db $4 -user $5 -password $6 -timeout 10

# проверка доступности опубликованных веб сервисов 1С
#	host - строка, адрес http сервиса (ip) с протоколом или без, куда будет проксирован запрос
#	db - строка, имя базы данных 1С
#	user - строка, пользователь для аутентификации на стороне http сервиса
#	password - строка, пароль пользователя для аутентификации на стороне http сервиса
#	timeout - строка, таймаут запроса к http сервису. Не обязательный, по умолчанию 30 сек
UserParameter=zabbix.http.ping[*],zagent_proxy ping -host $1 -db $2 -user $3 -password $4 -timeout 10

7. Перезапустить службу zabbix_agent